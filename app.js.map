{"mappings":"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","sources":["public/js/index.js","public/js/map.js","public/js/login.js","public/js/alert.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["import '@babel/polyfill';\r\nimport './map';\r\nimport { login, logout } from './login';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\n\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (userDataForm) {\r\n  userDataForm.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    form.append('name', document.querySelector('.form-user-data #name').value);\r\n    form.append(\r\n      'email',\r\n      document.querySelector('.form-user-data #email').value,\r\n    );\r\n    form.append(\r\n      'photo',\r\n      document.querySelector('.form-user-data #photo').files[0],\r\n    );\r\n\r\n    console.log(form);\r\n\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n    const passwordCurrent = document.querySelector('#password-current').value;\r\n    const password = document.querySelector('#password').value;\r\n    const passwordConfirm = document.querySelector('#password-confirm').value;\r\n    updateSettings({ passwordCurrent, password, passwordConfirm }, 'password');\r\n  });\r\n\r\n  document.querySelector('.btn--save-password').textContent = 'Save password';\r\n  document.querySelector('#password-current').value = '';\r\n  document.querySelector('#password').value = '';\r\n  document.querySelector('#password-confirm').value = '';\r\n}\r\n\r\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', e => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n","import L from 'leaflet';\r\n\r\nconst mapContainer = document.getElementById('map');\r\nif (mapContainer) {\r\n  var map = L.map('map').setView([51.505, -0.09], 13);\r\n\r\n  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    maxZoom: 19,\r\n    attribution:\r\n      '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\r\n  }).addTo(map);\r\n}\r\nexport default map;\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    console.log(err.response);\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n    if ((res.data.status = 'success')) location.reload(true);\r\n    location.href = '/';\r\n  } catch (err) {\r\n    showAlert('error', 'Error logging out! Try again');\r\n  }\r\n};\r\n","export const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type is 'success' or 'error'\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const updateSettings = async (data, type) => {\r\n  // type is either 'passsword' or 'data'\r\n\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} update successfully`);\r\n      window.setTimeout(() => {\r\n        location.assign('/me');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    console.log(err.response);\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\nconst stripe = Stripe(\r\n  'pk_test_51OY3XhBa66NB5bPqkfz0Uzs9wIQMgMo3tFL9YuPWNs0guxmsCpN2ZTIWQHaEmS7oYkVQMikyT83vlgqig2mUInHO00i30TXuVj',\r\n);\r\n\r\nexport const bookTour = async tourId => {\r\n  // 1) Get checkout session from API\r\n  try {\r\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n    // 2) Create checkout form + charge credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"app.js.map","sourceRoot":"/"}